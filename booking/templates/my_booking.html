{% extends "user_base.html" %} {% load static %}{% load mathfilters %} {% block content %}

  
<h1>คิวของฉัน</h1>
<hr />
<br />

<div class="container-fluid">
<div class="row">
{% for q in my_list%}
  <div class="col-sm-4 md-3">
    <center>

        <table class="table table-light table-bordered " style=" font-size: 16px ;">
          <thead>
            <tr>
              <th colspan="2" style="text-align: center;">{{q.que_id.name_que}}</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><b>ลำดับคิว</b></td>
              <td>{{q.que_id.prefix}}{{q.id}}</td>
            </tr>

            <tr>
              <td><b>หน่วยงาน</b></td>
              <td>{{q.que_id.type_in_dep_id.dep_id.name_dep}}</td>
            </tr>

            <tr>
              <td><b>ประเภทบริการ</b></td>
              <td>{{q.que_id.type_in_dep_id.name_que_dep}}</td>
            </tr>

            <tr>
              <td><b>เบอร์โทรศัพท์</b></td>
              <td>{{q.phone}}</td>
            </tr>

            <tr>
              <td><b>วันที่</b></td>
              <td>{{q.que_id.date_start}} ถึง {{q.que_id.date_end}}</td>
            </tr>
           
            <tr>
              <td><b>เวลา</b></td>
              <td>{{q.que_id.time_start}} ถึง {{q.que_id.time_end}}</td>
            </tr>
           
     
            {% for key,value in thisdict.items %}
              {% if key == q.que_id.id %}
              
                <tr>
                <td><b>จำนวนคิวก่อนหน้า</b></td>
            
                <td>{{ value }}</td>
               
              </tr>

              <tr>
                <td><b>เวลารอ</b></td>
                 {% if value == 0 %}
                  <td style="color: red;">ถึงคิวของคุณแล้ว</td>
                {% else %}
                <td>{{ value|mul:q.que_id.wait_time }} นาที</td>
                 {%endif%}
              </tr>

             
              {%endif%}
            {%endfor%}




            <tr>
              <td>
                <div class="d-grid gap-2">
                  <a class="btn btn-warning btn-lg btn-block" href="{% url 'my_putoff' id=q.id%}">
                    เลื่อนคิว
                  </a>
                </div>
              </td>
              <td>
                <div class="d-grid gap-2"><a class="btn btn-danger btn-lg btn-block" href="{% url 'my_cancel' id=q.id%}">
                    ลบคิว
                  </a></div>
              </td>
            </tr>
          </tbody>
        </table>
    </center>
  </div>

{%endfor%}

</div>
</div>



{% endblock %}